<!DOCTYPE html>
<html>
<head>
	<title>OCR Results</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
<div class="container">
	<div class="header">
		<div class="header-content">
			<div class="title-section">
				<h1>👓 ШНЫРЬ v0.2</h1>
			</div>
			<div class="status-section">
				<div class="status-info">
					<span class="status-label">Статус:</span>
					<span class="status-value">{{formatStatus .Status.CurrentStatus}}</span>
					{{if .Status.UpdatedAt}}
					<span class="status-time">({{formatDateTime .Status.UpdatedAt}})</span>
					{{end}}
				</div>
				<div class="control-buttons">
					<button class="control-btn start-btn" onclick="sendAction('start')">🚀 Start</button>
					<button class="control-btn stop-btn" onclick="sendAction('stop')">🛑 Stop</button>
					<button class="control-btn restart-btn" onclick="sendAction('restart')">🔄 Restart</button>
				</div>
			</div>
		</div>
		
		<div class="tabs">
			<a href="/?tab=main" class="tab {{if eq .ActiveTab "main"}}active{{end}}">🏠 Главная</a>
			<a href="/?tab=item_search" class="tab {{if eq .ActiveTab "item_search"}}active{{end}}">🔍 Поиск по предмету</a>
		</div>
	</div>
	
	<div class="content">
		{{if eq .ActiveTab "item_search"}}
			{{template "item_search.html" .}}
		{{else}}
			{{template "main_tab.html" .}}
		{{end}}
	</div>
</div>

<!-- Модальные окна -->
{{template "modals.html" .}}

<script src="/static/js/app.js"></script>
<script>
function sendAction(action) {
	console.log('Отправляем действие:', action);
	
	fetch('/' + action, {
		method: 'POST',
		headers: {
			'Content-Type': 'application/json',
		}
	})
	.then(response => {
		if (response.ok) {
			console.log('Действие', action, 'успешно отправлено');
			// Обновляем страницу через 1 секунду, чтобы показать новый статус
			setTimeout(() => {
				window.location.reload();
			}, 1000);
		} else {
			console.error('Ошибка при отправке действия:', response.status);
			alert('Ошибка при отправке действия: ' + response.status);
		}
	})
	.catch(error => {
		console.error('Ошибка сети:', error);
		alert('Ошибка сети при отправке действия');
	});
}

function formatStatus(status) {
	if (status === 'stop') {
		return 'СТРАДАЕТ ХУЙНЕЙ';
	} else if (status === 'start' || status === 'restart') {
		return 'ОХОТА НА ЛОХА';
	} else {
		return status || 'НЕИЗВЕСТНО';
	}
}
</script>
</body>
</html> 