<div class="search-filters">
	<form method="GET" action="/" class="search-form">
		<input type="hidden" name="tab" value="{{.ActiveTab}}">
		<div class="search-row">
			<input type="text" name="search" value="{{.SearchQuery}}" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –≤–ª–∞–¥–µ–ª—å—Ü—É, —Ü–µ–Ω–µ..." class="search-input">
			<input type="number" name="min_price" value="{{.MinPrice}}" placeholder="–ú–∏–Ω. —Ü–µ–Ω–∞" class="price-input" min="0" step="0.01">
			<input type="number" name="max_price" value="{{.MaxPrice}}" placeholder="–ú–∞–∫—Å. —Ü–µ–Ω–∞" class="price-input" min="0" step="0.01">
			<button type="submit" class="search-button">üîç –ü–æ–∏—Å–∫</button>
			{{if or .SearchQuery .MinPrice .MaxPrice}}
			<a href="/?tab={{.ActiveTab}}" class="clear-button">‚ùå –û—á–∏—Å—Ç–∏—Ç—å</a>
			{{end}}
		</div>
	</form>
</div>

<div class="items-list-section">
	<h2>üéØ –®–ù–´–†–¨ –ò–©–ï–¢</h2>
	<div class="items-list-table">
		<table>
			<thead>
				<tr>
					<th>ID</th>
					<th>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞</th>
					<th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
					<th>–ú–∏–Ω. —Ü–µ–Ω–∞</th>
					<th>–î–æ–±–∞–≤–ª–µ–Ω</th>
				</tr>
			</thead>
			<tbody>
				{{range .ItemsList}}
				<tr>
					<td>{{.ID}}</td>
					<td>{{.Name}}</td>
					<td>{{formatCategory .Category}}</td>
					<td>{{if gt .MinPrice 0}}{{formatPrice (printf "%.2f" .MinPrice)}}{{else}}-{{end}}</td>
					<td>{{formatDateTime .CreatedAt}}</td>
				</tr>
				{{end}}
			</tbody>
		</table>
	</div>
</div>

{{if .SearchQuery}}
<div class="search-info">
	üîç –ü–æ–∏—Å–∫: "{{.SearchQuery}}" | –ù–∞–π–¥–µ–Ω–æ: {{.TotalCount}} –∑–∞–ø–∏—Å–µ–π
</div>
{{end}}

<div class="stats">
	üìä –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{.CurrentPage}} –∏–∑ {{.TotalPages}} | 
	üìã –ü–æ–∫–∞–∑–∞–Ω–æ {{len .Results}} –∑–∞–ø–∏—Å–µ–π –∏–∑ {{.TotalCount}}
</div>

<div class="mobile-table">
<table>
<tr>
	<th>Structured Data</th>
	<th>Screenshot</th>
	<th>Created</th>
</tr>
{{range .Results}}
<tr data-raw-text="{{jsEscape .RawText}}" data-id="{{.ID}}" data-image="{{base64encode .ImageData}}" data-image-path="{{.ImagePath}}" data-debug="{{jsEscape .DebugInfo}}" data-items="{{if .Items}}true{{else}}false{{end}}" data-structured-items='{{if .Items}}[{{range $index, $item := .Items}}{{if $index}},{{end}}{"title":"{{jsEscape $item.Title}}","titleShort":"{{jsEscape $item.TitleShort}}","enhancement":"{{jsEscape $item.Enhancement}}","price":"{{jsEscape $item.Price}}","package":{{$item.Package}},"owner":"{{jsEscape $item.Owner}}","count":"{{jsEscape $item.Count}}","category":"{{jsEscape $item.Category}}"}{{end}}]{{else}}[]{{end}}' onclick="openDetailModalFromData(this)" style="cursor: pointer;">
<td>
	{{if .Items}}
	<div class="structured-table">
	<table>
	<tr><th>Title</th><th>Title Short</th><th>Enhancement</th><th>Price</th><th>Count</th><th>Package</th><th>Owner</th><th>Category</th></tr>
	{{range .Items}}
	<tr class="cheapest-item-{{.Enhancement}}-{{.Price}}">
	<td>{{.Title}}</td>
	<td>{{.TitleShort}}</td>
	<td>{{.Enhancement}}</td>
	<td>{{formatPrice .Price}}</td>
	<td>{{.Count}}</td>
	<td>{{if .Package}}‚úîÔ∏è{{end}}</td>
	<td>{{.Owner}}</td>
	<td>{{formatCategory .Category}}</td>
	</tr>
	{{end}}
	</table>
	</div>
	{{else}}
	<div class="no-data">No structured data</div>
	{{end}}
</td>
<td class="image-cell">
	{{if .ImageData}}
	<img src="data:image/png;base64,{{base64encode .ImageData}}" class="ocr-image" style="cursor: pointer;" />
	{{else}}
	<div class="no-data">No image data</div>
	{{end}}
</td>
<td class="date-cell">{{formatDateTime .CreatedAt}}</td>
</tr>
{{end}}
</table>
</div>

<div class="pagination">
	{{if .HasPrev}}
		<a href="?page=1{{if .SearchQuery}}&search={{.SearchQuery}}{{end}}{{if .MinPrice}}&min_price={{.MinPrice}}{{end}}{{if .MaxPrice}}&max_price={{.MaxPrice}}{{end}}&tab={{.ActiveTab}}">¬´ –ü–µ—Ä–≤–∞—è</a>
		<a href="?page={{.PrevPage}}{{if .SearchQuery}}&search={{.SearchQuery}}{{end}}{{if .MinPrice}}&min_price={{.MinPrice}}{{end}}{{if .MaxPrice}}&max_price={{.MaxPrice}}{{end}}&tab={{.ActiveTab}}">‚Äπ –ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
	{{else}}
		<span class="disabled">¬´ –ü–µ—Ä–≤–∞—è</span>
		<span class="disabled">‚Äπ –ü—Ä–µ–¥—ã–¥—É—â–∞—è</span>
	{{end}}
	
	{{range $i := sequence .CurrentPage .TotalPages}}
		{{if eq $i $.CurrentPage}}
			<span class="current">{{$i}}</span>
		{{else}}
			<a href="?page={{$i}}{{if $.SearchQuery}}&search={{$.SearchQuery}}{{end}}{{if $.MinPrice}}&min_price={{$.MinPrice}}{{end}}{{if $.MaxPrice}}&max_price={{$.MaxPrice}}{{end}}&tab={{$.ActiveTab}}">{{$i}}</a>
		{{end}}
	{{end}}
	
	{{if .HasNext}}
		<a href="?page={{.NextPage}}{{if .SearchQuery}}&search={{.SearchQuery}}{{end}}{{if .MinPrice}}&min_price={{.MinPrice}}{{end}}{{if .MaxPrice}}&max_price={{.MaxPrice}}{{end}}&tab={{.ActiveTab}}">–°–ª–µ–¥—É—é—â–∞—è ‚Ä∫</a>
		<a href="?page={{.TotalPages}}{{if .SearchQuery}}&search={{.SearchQuery}}{{end}}{{if .MinPrice}}&min_price={{.MinPrice}}{{end}}{{if .MaxPrice}}&max_price={{.MaxPrice}}{{end}}&tab={{.ActiveTab}}">–ü–æ—Å–ª–µ–¥–Ω—è—è ¬ª</a>
	{{else}}
		<span class="disabled">–°–ª–µ–¥—É—é—â–∞—è ‚Ä∫</span>
		<span class="disabled">–ü–æ—Å–ª–µ–¥–Ω—è—è ¬ª</span>
	{{end}}
</div> 